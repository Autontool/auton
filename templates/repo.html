{% extends "base2.html"%}
{%block body%}

<script src="https://ahmad88me.github.io/outlinejs/cdn/outline.js"></script>
<!--<canvas id="myCanvas"  height="200" width="200"  style="border:1px solid #d3d3d3;">-->
<!--            Your browser does not support the canvas element.-->
<!--</canvas>-->
<canvas id="myCanvas"  height="200" width="200" >
            Your browser does not support the canvas element.
</canvas>

   {%for orun in oruns reversed%}
  <div class="card">
    <div class="card-header" role="tab" >
      <h4 class="card-title">
        <a role="button" data-toggle="collapse" href="#coll{{r.id}}">
          {{orun.timestamp}} ({{orun.repo.url}})
        </a>
      </h4>
    </div>
      <div class="panel-body" id="coll{{r.id}}">
            {%for otask in orun.tasks.all%}
            {%if otask.success%}
                    <li class="list-group-item " >
                    {{otask.name}} | {{otask.description}}
                        <span style="color: green;">
                        <svg  width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
</svg>
                        </span>
                    </li>

            {%else%}
                {%if otask.finished%}



                          <li class="list-group-item alert alert-danger" role="alert">{{otask.name}} | {{otask.description}}
                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
</svg>
                          </li>

            {%else%}
                                    <li class="list-group-item alert alert-info" role="alert">{{otask.name}} | {{otask.description}}
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-repeat" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
  <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
</svg>
</li>
            {%endif%}
          {%endif%}
            {%endfor%}
      </div>
  </div>
    {%endfor%}





 <script>
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");
        ctx.canvas.width = window.innerWidth * 0.95;

        var g = new OutlineGraph(ctx, {"title_color": "black",
                                 "items_color": "blue",
                                 "inner_color": "#3498DB",
                                 "title_font": "15px Helvetica",
                                 "items_font": "10px Comic Sans MS",
                                 "points": [
                                    {"title": "Pending", "items": []},
                                    {"title": "Diagrams", "items": []},
                                    {"title": "Documentation", "items": []},
                                    {"title": "Evaluation", "items": []},
                                    {"title": "JSON-LD", "items": []},
                                    {"title": "Validation", "items": []},
                                    {"title": "Finished", "items": []},
                                 ]});

            /* testing
                 var g = new OutlineGraph(ctx, {"title_color": "black",
                                 "items_color": "blue",
                                 "inner_color": "#3498DB",
                                 "title_font": "15px Helvetica",
                                 "items_font": "10px Comic Sans MS",
                                 "points": [
                                        {"title": "Pending", "items": ["abc", "def"]},
                                        {"title": "Diagrams", "items": ["xyz1"]},
                                        {"title": "Documentation", "items": ["xyz22"]},
                                        {"title": "Evaluation", "items": ["xyz33"]},
                                        {"title": "JSON-LD", "items": ["xyz44"]},
                                        {"title": "Validation", "items": ["xyz55"]},
                                        {"title": "Finished", "items": ["finals"]}
                                 ]});
        */
        g.draw();
        g.draw_inner(0);

function compute_index(j){
   return 2;
}


var outline_function = function(){

    var graph_data = {
                 "title_color": "black",
                 "items_color": "blue",
                 "inner_color": "#3498DB",
                 "title_font": "15px Helvetica",
                 "items_font": "10px Comic Sans MS",
                 "points": [
                 ]
     }


    $.getJSON('get_outline', function(data){
        var stages = Object.keys(data["stages"]);
        var i;
        var points = [];
        for(i=0;i<stages.length;i++){
            p = {"title": stages[i], "items": data["stages"][stages[i]]}
            points.push(p);
        }
        graph_data["points"] = points
        graph_data["points"] = [
            {"title": "Pending", "items": data["stages"]["pending"]},
            {"title": "Diagrams", "items": data["stages"]["diagram"]},
            {"title": "Documentation", "items": data["stages"]["documentation"]},
            {"title": "Evaluation", "items": data["stages"]["evaluation"]},
            {"title": "JSON-LD", "items": data["stages"]["jsonld"]},
            {"title": "Validation", "items": data["stages"]["validation"]},
            {"title": "Finished", "items": data["stages"]["finished"]}
        ]
        delete window.g;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        g = new OutlineGraph(ctx, graph_data);
        g.draw();
        g.draw_inner(data["inner"]);
    });

}
setInterval(outline_function, 4000);
outline_function();
</script>

{% endblock %}
