{% extends "base.html"%}
{%block body%}


<script src="http://fgnass.github.io/spin.js/spin.min.js"></script>




<input type="hidden" id="button"/>
	<div id="box">
		<!-- Click Me To Return! -->
	</div>
	
	
	<div id="myspinner"></div>
	<div id="screen" >
		
	</div>



<style>


#myspinner{
	z-index: 10;
}


#screen
{

	position: absolute;	
	left: 0;
	top: 0;
	background: #000;
	
}


</style>



<script>


function GetURLParameter(sParam)
{
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++)
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == sParam)
        {
            return sParameterName[1];
        }
    }
    return '';
}


</script>







</br>

<span id="profiletables">


<h3>Choose one of the below repo by clicking on it</h3>
<table class="table table-hover">
<tr class="">
	<td>Repository</td>
	<td>Status</td>
	<td>Last used</td>
	<td>ar2dtool</td>
	<td>OOPS</td>
	<td >Widoco</td>
</tr>
{%for r in repos%}
	<tr class="repo" url="{{r.url}}">
		<td>{{r.url}}</td>
		<td>{{r.state}}</td>
		<td>{{r.last_used}}</td>
		<td>{{r.ar2dtool_enable}}</td>
		<td>{{r.oops_enable}}</td>
		<td>{{r.widoco_enable}}</td>
	<tr>
{%endfor%}
</table>

</br> </br> </br>


<table class="table">
<tr class="">
	<td>Ontology</td>
	<td>ar2dtool</td>
	<td>OOPS</td>
	<td >Widoco</td>
</tr>
{%for o in ontologies%}
	<tr class="ontology" >
		<td>{{o.ontology}}</td>
		
		<td><input type="checkbox" name="{{o.ontology}}-ar2dtool" checked>
</td>
		<td><input type="checkbox" name="{{o.ontology}}-oops" checked>
</td>
		<td><input type="checkbox" name="{{o.ontology}}-widoco" checked>
</td>
	<tr>
{%endfor%}
</table>




</br>
<form  id="toolsform" action="" method="POST">
<input id="savebtn" type="submit" value="Save" class="form-control btn btn-default "/>
<input id="toolsvalues" name="toolsvalues" type="hidden" value=""/>
</form>


<style>
.bootstrap-switch .bootstrap-switch-handle-on.bootstrap-switch-primary,
.bootstrap-switch .bootstrap-switch-handle-off.bootstrap-switch-primary {
  color: #fff !important;
  background: #333333 !important;
}

</style>


<script>
	var result={};
$( document ).ready(function() {
	
	var False=false;
	var True=true;
	{%for o in ontologies%}
	//init required
	$("[name='{{o.ontology}}-ar2dtool']").bootstrapSwitch();
	$("[name='{{o.ontology}}-oops']").bootstrapSwitch();
	$("[name='{{o.ontology}}-widoco']").bootstrapSwitch();

	//setting the values
	$("[name='{{o.ontology}}-ar2dtool']").bootstrapSwitch('state',{{o.ar2dtool}});
	$("[name='{{o.ontology}}-oops']").bootstrapSwitch('state',{{o.oops}});
	$("[name='{{o.ontology}}-widoco']").bootstrapSwitch('state',{{o.widoco}});
	
	//appending the values to be send later to the server
	result["{{o.ontology}}-ar2dtool"] = $("[name='{{o.ontology}}-ar2dtool']").bootstrapSwitch('state');
	result["{{o.ontology}}-oops"]     = $("[name='{{o.ontology}}-oops']").bootstrapSwitch('state');
	result["{{o.ontology}}-widoco"]   = $("[name='{{o.ontology}}-widoco']").bootstrapSwitch('state');

	
	$("[name='{{o.ontology}}-ar2dtool']").on('switchChange.bootstrapSwitch', function(event, state) {
		console.log(state); // true | false
		result["{{o.ontology}}-ar2dtool"] = $("[name='{{o.ontology}}-ar2dtool']").bootstrapSwitch('state');
	});

	$("[name='{{o.ontology}}-oops']").on('switchChange.bootstrapSwitch', function(event, state) {
		console.log(state); // true | false
		result["{{o.ontology}}-oops"]     = $("[name='{{o.ontology}}-oops']").bootstrapSwitch('state');
	});

	$("[name='{{o.ontology}}-widoco']").on('switchChange.bootstrapSwitch', function(event, state) {
		console.log(state); // true | false
		result["{{o.ontology}}-widoco"]   = $("[name='{{o.ontology}}-widoco']").bootstrapSwitch('state');
	});

	$("#toolsform").submit(function(event){
/* 		$.ajax({
		    url:   "",
		    data:  result,
		    async: false
		}); */
		$("#toolsvalues").attr("value") = result;
		alert("savebtn is clicked");
	});	
	
	
	
	{%endfor%}

});

</script>



</span>









<script>


$( document ).ready(function() {
	
	var opts = {
		  lines: 13, // The number of lines to draw
		  length: 40, // The length of each line
		  width: 22, // The line thickness
		  radius: 60, // The radius of the inner circle
		  corners: 1, // Corner roundness (0..1)
		  rotate: 0, // The rotation offset
		  direction: 1, // 1: clockwise, -1: counterclockwise
		  color: '#BBB', // #rgb or #rrggbb or array of colors
		  speed: 1, // Rounds per second
		  trail: 60, // Afterglow percentage
		  shadow: false, // Whether to render a shadow
		  hwaccel: false, // Whether to use hardware acceleration
		  className: 'spinner', // The CSS class to assign to the spinner
		  zIndex: 2e9, // The z-index (defaults to 2000000000)
		  top: '50%', // Top position relative to parent
		  left: '50%' // Left position relative to parent
		};
	var target = document.getElementById('myspinner');
	var spinner = new Spinner(opts);//.spin(target);
	//var spinner = new Spinner(opts).spin(target);
	
	
	
	var greyout = function(){
		//alert("clicked");
		spinner.spin(target);
		//$('#screen').css({"position": "absolute"});
		$('#screen').css({	"display": "block", opacity: 0.7, "width":$(document).width(),"height":$(document).height()});
		$('#box').css({"display": "block"}).click(function(){$(this).css("display", "none");$('#screen').css("display", "none")});
	}

		
	
	$(".repo").click(function() {
		 //window.location.href = "?repo="+$(this).attr('url');
		//spinner.spin(target);
		//alert("check1");
		greyout(); 
		$.ajax({
		  method: "GET",
		  url: window.location.href+"?repo="+$(this).attr('url'),
		  //data: { name: "John", location: "Boston" }
		}).done(function( resp ) {
		    //alert("Done");
		    spinner.stop();
		    $('#box').click();

		    //$( "body" ).off( "click");
		    
		    
			var startBody = resp.indexOf('<span id="profiletables">');
			var newresp = resp.substring(startBody,resp.length-1);
			var endBody = newresp.indexOf("</span>")+startBody;
			var bodyString = resp.substring(startBody+25,endBody);
			//alert("startBody: "+startBody+", endBody: "+endBody)
			//console.log(bodyString);
	       //jQuery('head').html(headString);
	       //$('#hoo').html("<h1>For some reason</h1>");
	       $('#profiletables').html(bodyString);
		    
		    //var htmlbody = newhtml.split("<body")[1].split(">").slice(1).join(">").split("</body")[0];
			//alert(htmlbody);
			//$("body").html(htmlbody)
		});
		 
	});
	$('.repo').each(function(){
		var r = GetURLParameter('repo');
		//alert("<"+r+">");
		if (r==$(this).attr('url')){
			$(this).addClass("highl");
		}
		else{
			$(this).removeClass("highl");			
		}
	});

	
});



	


</script>






{% endblock %}

